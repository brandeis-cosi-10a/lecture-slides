let skills = {
    "Variables": {
      "name": "Variables",
      "problems": {
        "Mad Libs": {
          "ps": "PS1",
          "selected": false
        },
        "Weight Comparisons": {
          "ps": "PS1",
          "selected": false
        },
        "Interest Calculator": {
          "ps": "PS1",
          "selected": false
        },
        "Light wavelength analyzer": {
          "ps": "PS2",
          "selected": false
        },
        "Choose your own adventure": {
          "ps": "PS2",
          "selected": false
        },
        "Dice game: debugging": {
          "ps": "PS2",
          "selected": false
        },
        "Tip Calculator": {
          "ps": "PS3",
          "selected": false
        },
        "Number guessing": {
          "ps": "PS4",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        },
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        }
      },
      "cap": 4
    },
    "Datatypes": {
      "name": "Datatypes",
      "problems": {
        "Weight Comparisons": {
          "ps": "PS1",
          "selected": false
        },
        "Interest Calculator": {
          "ps": "PS1",
          "selected": false
        },
        "Dice game: debugging": {
          "ps": "PS2",
          "selected": false
        },
        "Tip Calculator": {
          "ps": "PS3",
          "selected": false
        },
        "Number Guessing": {
          "ps": "PS4",
          "selected": false
        },
        "Number filter": {
          "ps": "PS5",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        }
      },
      "cap": 4
    },
    "Expressions": {
      "name": "Expressions",
      "problems": {
        "Mad Libs": {
          "ps": "PS1",
          "selected": false
        },
        "Weight Comparisons": {
          "ps": "PS1",
          "selected": false
        },
        "Interest Calculator": {
          "ps": "PS1",
          "selected": false
        },
        "Light wavelength analyzer": {
          "ps": "PS2",
          "selected": false
        },
        "Dice game: debugging": {
          "ps": "PS2",
          "selected": false
        },
        "Tip Calculator": {
          "ps": "PS3",
          "selected": false
        },
        "Multiplication Tables": {
          "ps": "PS4",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Factor finder": {
          "ps": "PS6",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "input()": {
      "name": "input()",
      "problems": {
        "Mad Libs": {
          "ps": "PS1",
          "selected": false
        },
        "Weight Comparisons": {
          "ps": "PS1",
          "selected": false
        },
        "Interest Calculator": {
          "ps": "PS1",
          "selected": false
        },
        "Choose your own adventure": {
          "ps": "PS2",
          "selected": false
        },
        "Tip Calculator": {
          "ps": "PS3",
          "selected": false
        },
        "Number Guessing": {
          "ps": "PS4",
          "selected": false
        },
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Number filter": {
          "ps": "PS5",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        },
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        }
      },
      "cap": 4
    },
    "String escaping": {
      "name": "String escaping",
      "problems": {
        "String escaping": {
          "ps": "PS1",
          "selected": false
        },
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Multiplication Tables": {
          "ps": "PS4",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        }
      },
      "cap": 4
    },
    "Conditionals": {
      "name": "Conditionals",
      "problems": {
        "Light wavelength analyzer": {
          "ps": "PS2",
          "selected": false
        },
        "Choose your own adventure": {
          "ps": "PS2",
          "selected": false
        },
        "Dice game: debugging": {
          "ps": "PS2",
          "selected": false
        },
        "Tip Calculator": {
          "ps": "PS3",
          "selected": false
        },
        "Number Guessing": {
          "ps": "PS4",
          "selected": false
        },
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Number filter": {
          "ps": "PS5",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Vowel Filter": {
          "ps": "PS6",
          "selected": false
        },
        "Factor finder": {
          "ps": "PS6",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Conditional logic": {
      "name": "Conditional logic",
      "problems": {
        "Light wavelength analyzer": {
          "ps": "PS2",
          "selected": false
        },
        "Choose your own adventure": {
          "ps": "PS2",
          "selected": false
        },
        "Tip Calculator": {
          "ps": "PS3",
          "selected": false
        },
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Vowel Filter": {
          "ps": "PS6",
          "selected": false
        },
        "Age range filter": {
          "ps": "PS7",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Function invocation": {
      "name": "Function invocation",
      "problems": {
        "Old lady": {
          "ps": "PS3",
          "selected": false
        },
        "Dice Game Refactored": {
          "ps": "PS3",
          "selected": false
        },
        "Drawing Squares": {
          "ps": "PS3",
          "selected": false
        },
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Dice Game Loops": {
          "ps": "PS4",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        }
      },
      "cap": 4
    },
    "Function definition": {
      "name": "Function definition",
      "problems": {
        "Old lady": {
          "ps": "PS3",
          "selected": false
        },
        "Dice Game Refactored": {
          "ps": "PS3",
          "selected": false
        },
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Dice Game Loops": {
          "ps": "PS4",
          "selected": false
        },
        "Multiplication Tables": {
          "ps": "PS4",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Vowel Filter": {
          "ps": "PS6",
          "selected": false
        },
        "Factor finder": {
          "ps": "PS6",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Age range filter": {
          "ps": "PS7",
          "selected": false
        },
        "Birthday Tracker": {
          "ps": "PS7",
          "selected": false
        },
        "Word Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Function parameters": {
      "name": "Function parameters",
      "problems": {
        "Old lady": {
          "ps": "PS3",
          "selected": false
        },
        "Dice Game Refactored": {
          "ps": "PS3",
          "selected": false
        },
        "Drawing Squares": {
          "ps": "PS3",
          "selected": false
        },
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Dice Game Loops": {
          "ps": "PS4",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Function returns": {
      "name": "Function returns",
      "problems": {
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Multiplication Tables": {
          "ps": "PS4",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Vowel Filter": {
          "ps": "PS6",
          "selected": false
        },
        "Factor finder": {
          "ps": "PS6",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Age range filter": {
          "ps": "PS7",
          "selected": false
        },
        "Birthday Tracker": {
          "ps": "PS7",
          "selected": false
        },
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        },
        "Word Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Globals": {
      "name": "Globals",
      "problems": {
        "Dice Game Refactored": {
          "ps": "PS3",
          "selected": false
        },
        "Dice Game Loops": {
          "ps": "PS4",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        }
      },
      "cap": 3
    },
    "Loops - for/range": {
      "name": "Loops - for/range",
      "problems": {
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Dice Game Loops": {
          "ps": "PS4",
          "selected": false
        },
        "Number filter": {
          "ps": "PS5",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Factor finder": {
          "ps": "PS6",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Word Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Loops - while": {
      "name": "Loops - while",
      "problems": {
        "Number Guessing": {
          "ps": "PS4",
          "selected": false
        },
        "Number filter": {
          "ps": "PS5",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        },
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        }
      },
      "cap": 4
    },
    "Cumulative algorithm": {
      "name": "Cumulative algorithm",
      "problems": {
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Number filter": {
          "ps": "PS5",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Birthday Tracker": {
          "ps": "PS7",
          "selected": false
        },
        "Word Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Fencepost algorithm": {
      "name": "Fencepost algorithm",
      "problems": {
        "Multiplication Tables": {
          "ps": "PS4",
          "selected": false
        },
        "Number filter": {
          "ps": "PS5",
          "selected": false
        },
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 3
    },
    "Loops - nested": {
      "name": "Loops - nested",
      "problems": {
        "Multiplication Tables": {
          "ps": "PS4",
          "selected": false
        },
        "Factor finder": {
          "ps": "PS6",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 3
    },
    "Loops - choosing structure": {
      "name": "Loops - choosing structure",
      "problems": {
        "Number Guessing": {
          "ps": "PS4",
          "selected": false
        },
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Dice Game Loops": {
          "ps": "PS4",
          "selected": false
        },
        "Number filter": {
          "ps": "PS5",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        }
      },
      "cap": 4
    },
    "Lists get/set": {
      "name": "Lists get/set",
      "problems": {
        "Number filter": {
          "ps": "PS5",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Factor finder": {
          "ps": "PS6",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Age range filter": {
          "ps": "PS7",
          "selected": false
        },
        "Birthday Tracker": {
          "ps": "PS7",
          "selected": false
        },
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "List iteration": {
      "name": "List iteration",
      "problems": {
        "Number filter": {
          "ps": "PS5",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Vowel Filter": {
          "ps": "PS6",
          "selected": false
        },
        "Factor finder": {
          "ps": "PS6",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Birthday Tracker": {
          "ps": "PS7",
          "selected": false
        },
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Lists - nested": {
      "name": "Lists - nested",
      "problems": {
        "Factor finder": {
          "ps": "PS6",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "String manipulation": {
      "name": "String manipulation",
      "problems": {
        "Vowel Filter": {
          "ps": "PS6",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Word Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        }
      },
      "cap": 4
    },
    "Tuples": {
      "name": "Tuples",
      "problems": {
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        },
        "Word Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "References": {
      "name": "References",
      "problems": {
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        },
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 3
    },
    "Dictionaries get/set": {
      "name": "Dictionaries get/set",
      "problems": {
        "Birthday Tracker": {
          "ps": "PS7",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Dictionary iteration": {
      "name": "Dictionary iteration",
      "problems": {
        "Age range filter": {
          "ps": "PS7",
          "selected": false
        },
        "Birthday Tracker": {
          "ps": "PS7",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        },
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Dictionary filtering": {
      "name": "Dictionary filtering",
      "problems": {
        "Age range filter": {
          "ps": "PS7",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 2
    },
    "Sorting": {
      "name": "Sorting",
      "problems": {
        "Birthday Tracker": {
          "ps": "PS7",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 3
    },
    "Sets": {
      "name": "Sets",
      "problems": {
        "Word Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        },
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Nested data structures": {
      "name": "Nested data structures",
      "problems": {
        "Birthday Tracker": {
          "ps": "PS7",
          "selected": false
        },
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        },
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Data structures - choosing appropriately": {
      "name": "Data structures - choosing appropriately",
      "problems": {
        "Contacts App": {
          "ps": "PS8",
          "selected": false
        },
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        },
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 3
    },
    "File I/O": {
      "name": "File I/O",
      "problems": {
        "Word Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        },
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "File I/O - CSVs": {
      "name": "File I/O - CSVs",
      "problems": {
        "Lottery Analyzer": {
          "ps": "PS8",
          "selected": false
        }
      },
      "cap": 1
    },
    "File I/O - JSON": {
      "name": "File I/O - JSON",
      "problems": {
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 2
    },
    "Classes - definition": {
      "name": "Classes - definition",
      "problems": {
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 1
    },
    "Classes - usage": {
      "name": "Classes - usage",
      "problems": {
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 1
    },
    "Unit Testing": {
      "name": "Unit Testing",
      "problems": {
        "Calendar Assistant": {
          "ps": "PS4",
          "selected": false
        },
        "Multiplication Tables": {
          "ps": "PS4",
          "selected": false
        },
        "Odd Calendar": {
          "ps": "PS5",
          "selected": false
        },
        "Vowel Filter": {
          "ps": "PS6",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Age range filter": {
          "ps": "PS7",
          "selected": false
        },
        "Birthday Tracker": {
          "ps": "PS7",
          "selected": false
        },
        "Hiking Trails": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Functional Decomposition": {
      "name": "Functional Decomposition",
      "problems": {
        "Old lady": {
          "ps": "PS3",
          "selected": false
        },
        "To-do list": {
          "ps": "PS5",
          "selected": false
        },
        "Pig Latin": {
          "ps": "PS6",
          "selected": false
        },
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    },
    "Using IDE": {
      "name": "Using IDE",
      "problems": {
        "Hello World": {
          "ps": "PS0",
          "selected": false
        },
        "Light wavelength analyzer": {
          "ps": "PS2",
          "selected": false
        }
      },
      "cap": 1
    },
    "Debugging": {
      "name": "Debugging",
      "problems": {
        "Dice game: debugging": {
          "ps": "PS2",
          "selected": false
        },
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        },
        "Nobel Prizes": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 3
    },
    "Using pre-existing code": {
      "name": "Using pre-existing code",
      "problems": {
        "Dice game: debugging": {
          "ps": "PS2",
          "selected": false
        },
        "Dice Game Refactored: Using pre": {
          "ps": "PS3",
          "selected": false
        },
        "Dice Game Loops: Using pre": {
          "ps": "PS4",
          "selected": false
        },
        "Dice Game Again": {
          "ps": "PS7",
          "selected": false
        },
        "Importing Contacts": {
          "ps": "PS9",
          "selected": false
        }
      },
      "cap": 4
    }
  };


function toggleProblem(skill, problem) {
    // toggle the checkbox for this skill/problem
    setProblem(skill, problem, !skills[skill].problems[problem].selected);
}

function setProblem(skill, problem, value, up=true) {
    skills[skill].problems[problem].selected = value;
    document.getElementById(skill + "-" + problem + "-selected").checked = value;
    if(up) {
        update();
    }

}

function setSkill(skill, value) {
    for(const problemname in skills[skill].problems) {
        setProblem(skill, problemname, value, false);
    }
    update();
}

function countPs() {
    let counts = {};
    for(const skillname in skills) {
        for(const problemname in skills[skillname].problems) {
            let problem = skills[skillname].problems[problemname];
            counts[problem.ps] = counts[problem.ps] || {count: 0, total: 0};

            counts[problem.ps].total++;
            if(problem.selected) {
                counts[problem.ps].count++;
            }
        }
    }
    return counts;
}

function setPs(ps, value) {
    for(const skillname in skills) {
        for(const problemname in skills[skillname].problems) {
            if(skills[skillname].problems[problemname].ps === ps) {
                setProblem(skillname, problemname, value, false);
            }
        }
    }
    update();
}

function update() {
    let earned_count = 0;
    let total_count = 0;
    for(const skillname in skills) {
        const cap = skills[skillname].cap;
        let selected = 0;
        for(const problemname in skills[skillname].problems) {
            if(skills[skillname].problems[problemname].selected) {
                selected++;
                console.log(problemname + " selected");
                document.getElementById(skillname + "-" + problemname + "-selected").innerHTML = "yes";
            } else {
                console.log(problemname + " not selected");
                document.getElementById(skillname + "-" + problemname + "-selected").innerHTML = "no";
            }
        }
        total_count += cap;
        const skill = document.getElementById(skillname + "-total");
        const skilltotal = selected > cap ? cap : selected;
        skill.innerHTML = skilltotal;
        earned_count += skilltotal;
    }
    document.getElementById("earned-skills").innerHTML = earned_count;
    document.getElementById("possible-skills").innerHTML = total_count;
    document.getElementById("skills-percentage").innerHTML = (earned_count / total_count * 100).toFixed(2);
    let grade = "E";
    if(earned_count >= 135) {
        grade = "A+";
    } else if(earned_count >= 130) {
        grade = "A";
    } else if(earned_count >= 127) {
        grade = "A-";
    } else if(earned_count >= 123) {
        grade = "B+";
    } else if(earned_count >= 117) {
        grade = "B";
    } else if(earned_count >= 113) {
        grade = "B-";
    } else if(earned_count >= 109) {
        grade = "C+";
    } else if(earned_count >= 103) {
        grade = "C";
    } else if(earned_count >= 99) {
        grade = "C-";
    } else if(earned_count >= 94) {
        grade = "D+";
    } else if(earned_count >= 89) {
        grade = "D";
    } else if(earned_count >= 85) {
        grade = "D-";
    } else {
        grade = "E";
    }
    document.getElementById("grade").innerHTML = grade;

    let ps = countPs();
    for(const p in ps) {
        document.getElementById(p + "-earned").innerHTML = ps[p].count;
        document.getElementById(p + "-total").innerHTML = ps[p].total;
    }
    console.log(skills);
    localStorage.setItem("skills", JSON.stringify(skills));
}

(function() {
    if(localStorage.getItem("skills") !== null) {
        skills = JSON.parse(localStorage.getItem("skills"));
    }
    console.log(skills);
    const skillcontainer = document.getElementById("container");
    const pscontainer = document.getElementById("pscontainer")
    let ps = [];
    for(const skillname in skills) {
        console.log(skillname)
        let content = "<div class='row skill-heading'>" +
        "<div class='ten columns' style='padding-top:10px'><b>" + skillname + "</b></div>" +
        //"<div class='one columns'><button style='padding: 0px 10px 0px 10px' onclick='setSkill(\"" + skillname + "\", true)'>all</button></div>" +
        //"<div class='one columns'><button style='padding: 0px 10px 0px 10px' onclick='setSkill(\"" + skillname + "\", false)'>none</button></div>" +
        "</div>";

        for(const problemname in skills[skillname].problems) {
            const problem = skills[skillname].problems[problemname];
            const selected = problem.selected ? "checked" : "";
            content += "<div class='row'>" +
                "<div class='ten columns'><i>" + problem.ps + "</i> " + problemname + "</div>" +
                "<div class='two columns'>" +
                    // add checkbox, call toggleProblem when toggled
                    "<input type='checkbox' " + selected + " id='" + skillname + "-" + problemname + "-selected' onclick='toggleProblem(\"" + skillname + "\", \"" + problemname + "\")'>" +
                "</div>" +
                "</div>";
            if (!ps.includes(problem.ps)) {
                ps.push(problem.ps);
            }
        }
        content += "<div class='row'>" +
            "<div class='ten columns'><b>" + skillname + " total: </div>" +
            "<div class='two columns'><b><span id='" + skillname + "-total'>" + 0 + "</span> / " + skills[skillname].cap + "</b></div>" +
            "</div>";

        skillcontainer.insertAdjacentHTML( 'beforeend', content);
    }

    ps.sort();
    for(const p of ps) {
        let content = "<div class='row'>" +
            "<div class='five columns' style='padding-top:10px'><b>" + p + "</b> (<span id='" + p + "-earned'></span>/<span id='" + p + "-total'></span>)</div>" +
            "<div class='seven columns'><button style='padding: 0px 10px 0px 10px' onclick='setPs(\"" + p + "\", true)'>all</button>" +
            "<button style='padding: 0px 10px 0px 10px' onclick='setPs(\"" + p + "\", false)'>none</button></div>" +
            "</div>";
        pscontainer.insertAdjacentHTML( 'beforeend', content);
    }
    update();
})();